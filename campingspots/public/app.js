import{initializeApp}from"https://www.gstatic.com/firebasejs/10.9.0/firebase-app.js";import{getAuth,signInWithEmailAndPassword,onAuthStateChanged}from"https://www.gstatic.com/firebasejs/10.9.0/firebase-auth.js";import{getDatabase,ref,onValue,remove,set}from"https://www.gstatic.com/firebasejs/10.9.0/firebase-database.js";import{app,auth,database,campingSpotsRef}from"../firebase-config.js";function initMap(){const t=new google.maps.Map(document.getElementById("map"),{center:{lat:56.9,lng:-4.6},zoom:6});onValue(campingSpotsRef,e=>{e.forEach(e=>{e=e.val();new google.maps.Marker({position:{lat:parseFloat(e.latitude),lng:parseFloat(e.longitude)},map:t,title:e.locationName})})})}async function loadGoogleMaps(){await import("https://maps.googleapis.com/maps/api/js?key=AIzaSyCgl_xTAa2SPIUcEJ1-Jo4ZD29PLwJHZHE&callback=initMap");initMap()}function displayCampingSpots(){onValue(campingSpotsRef,e=>{const a=document.getElementById("campingSpotList");a.innerHTML="",e.forEach(n=>{const e=n.val(),o=document.createElement("li");var t=document.createTextNode("Location: "+e.locationName),t=(o.appendChild(t),o.appendChild(document.createElement("br")),document.createTextNode("Description: "+e.description)),t=(o.appendChild(t),o.appendChild(document.createElement("br")),document.createTextNode("Latitude: "+e.latitude)),t=(o.appendChild(t),o.appendChild(document.createElement("br")),document.createTextNode("Longitude: "+e.longitude)),t=(o.appendChild(t),o.appendChild(document.createElement("br")),e.imageUri&&((t=document.createElement("img")).src=e.imageUri,t.alt="Camping Spot Image",o.appendChild(t)),document.createElement("button")),t=(t.textContent="Edit",t.addEventListener("click",()=>{const a=document.createElement("form");a.innerHTML=`
      <input type="text" id="editLocationName" value="${e.locationName}">
      <input type="text" id="editDescription" value="${e.description}">
      <input type="text" id="editLatitude" value="${e.latitude}">
      <input type="text" id="editLongitude" value="${e.longitude}">
      <button type="button" id="saveEditButton">Save</button>
    `,o.appendChild(a),a.querySelector("#saveEditButton").addEventListener("click",()=>{var e={locationName:a.querySelector("#editLocationName").value,description:a.querySelector("#editDescription").value,latitude:a.querySelector("#editLatitude").value,longitude:a.querySelector("#editLongitude").value},t=ref(database,"campingSpots/"+n.key);set(t,e),o.removeChild(a)})}),o.appendChild(t),document.createElement("button"));t.textContent="Delete",t.style.backgroundColor="#ff5c5c",t.style.color="#fff",t.style.border="none",t.style.padding="5px 10px",t.style.borderRadius="5px",t.style.cursor="pointer",t.style.transition="background-color 0.3s ease",t.addEventListener("click",()=>{remove(ref(database,"campingSpots/"+n.key))}),o.appendChild(t),a.appendChild(o)})})}onAuthStateChanged(auth,e=>{e?(console.log("User is signed in:",e),displayCampingSpots(),document.getElementById("loginForm").style.display="none",loadGoogleMaps()):(console.log("User is signed out"),document.getElementById("campingSpotList").innerHTML="",document.getElementById("loginForm").style.display="block")}),document.getElementById("loginButton").addEventListener("click",()=>{var e=document.getElementById("email").value,t=document.getElementById("password").value;"admin@admin.com"===e?signInWithEmailAndPassword(auth,e,t).then(e=>{e=e.user;console.log(e)}).catch(e=>{e.code;e=e.message;console.error(e)}):console.error("Only admin@admin.com is allowed to proceed with authentication.")});